name: Build Whisper.cpp for CoreELEC

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Install Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y gcc-aarch64-linux-gnu g++-aarch64-linux-gnu

      - name: Download Whisper.cpp Source
        run: |
          wget https://github.com/ggerganov/whisper.cpp/archive/refs/tags/v1.5.1.tar.gz
          tar -xvf v1.5.1.tar.gz

      - name: "DEBUG: Show me the build command"
        run: |
          cd whisper.cpp-1.5.1
          # --- ГЛАВНАЯ КОМАНДА ДЛЯ ДИАГНОСТИКИ ---
          # Флаг -n говорит make: "Не выполняй команды, просто покажи их мне"
          make -n main CC=aarch64-linux-gnu-gcc CXX=aarch64-linux-gnu-g++
